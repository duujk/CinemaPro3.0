var price = 10;
$(document).ready(function () {
    var $cart = $('#selected-seats'),
        $counter = $('#counter'),
        $total = $('#total');

    var sc = $('#seat-map').seatCharts({
        map: [
            'aaaaaaaaaa',
            'aaaaaaaaaa',
            '__________',
            'aaaaaaaa__',
            'aaaaaaaaaa',
            'aaaaaaaaaa',
            'aaaaaaaaaa',
            'aaaaaaaaaa',
            'aaaaaaaaaa',
            'aa__aa__aa'
        ],
        naming: {
            top : false,
            getLabel : function (character, row, column) {
                return column;
            }
        },
        legend: {
            node: $('legend'),
            items: [
                ['a', 'available', 'Option'],
                ['a', 'unavailable', 'Sold']
            ]
        },
        click: function () {
            if (this.status() == 'available') {
                $('<li>R' + (this.settings.row + 1) + ' S' + this.settings.label + '</li>')
                    .attr('id', 'cart-item-' + this.settings.id)
                    .data('seatId', this.settings.id)
                    .appendTo($cart);

                $counter.text(sc.find('selected').length + 1);
                $total.text(recalculateTotal(sc) + price);

                $('#cart-item-' + this.settings.id).remove();

                return 'available';
            } else if (this.status() == 'unavailable') {
                return this.style;
            }
        }
    });
    sc.get([]).status('unavailable');
});

function recalculateTotal(sc) {
    var total = 0;
    sc.find('selected').each(function () {
        total += price;
    });
    return total;
}